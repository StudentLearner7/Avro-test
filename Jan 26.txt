{
  "size": 10,
  "query": {
    "bool": {
      "must": [
        {
          "terms": {
            "key": ["value1", "value2"]  // Add all the key values you want to filter
        }
      ]
    }
  },
  "aggs": {
    "key_count": {
      "terms": {
        "field": "key",
        "size": 10  // Adjust the size as needed
      }
    }
  },
  "script_fields": {
    "max_doc_count": {
      "script": {
        "source": "doc['key'].length",
        "lang": "painless"
      }
    }
  }
}